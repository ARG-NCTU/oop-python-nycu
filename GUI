import tkinter as tk
from pyfirmata import Arduino, util

class ArduinoGUI:
    def __init__(self, master):
        self.master = master
        master.title("Arduino LED Frequency Control")

        # Connect to Arduino
        # Adjust your Arduino connection port accordingly
        self.board = Arduino('/dev/ttyUSB0') 
        # self.board = Arduino('/dev/ttyUSB1')
        # self.board = Arduino('/dev/ttyACM0')
        # self.board = Arduino('/dev/ttyACM1')

        # Get the LED pin
        self.led_pin = self.board.get_pin('d:9:p')  # d for digital, 9 for pin, p for PWM

        # Create a Scale widget for adjusting the frequency
        self.frequency_scale = tk.Scale(master, from_=1, to=100, orient=tk.HORIZONTAL, label="Frequency (Hz)", command=self.update_frequency)
        self.frequency_scale.set(50)  # Set initial frequency to 50 Hz
        self.frequency_scale.pack()

    def update_frequency(self, frequency):
        # Convert frequency to period in microseconds
        period = 1000000 / float(frequency)
        # Set the PWM frequency using the period
        self.board.set_pwm_period(self.led_pin.pin_number, period)

    def close(self):
        # Clean up and exit
        self.board.exit()
        self.master.destroy()

# Create the GUI window
root = tk.Tk()
app = ArduinoGUI(root)

# Ensure proper cleanup upon closing the window
root.protocol("WM_DELETE_WINDOW", app.close)

# Run the application
root.mainloop()
