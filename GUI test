import tkinter as tk
from pyfirmata import Arduino, util
import time

class ArduinoGUI:
    def __init__(self, master):
        self.master = master
        master.title("Arduino LED Brightness Control")

        # Connect to Arduino
        # Adjust your Arduino connection port accordingly
        self.board = Arduino('/dev/ttyUSB0') 
        # self.board = Arduino('/dev/ttyUSB1')
        # self.board = Arduino('/dev/ttyACM0')
        # self.board = Arduino('/dev/ttyACM1')

        # Get the LED pin
        self.led_pin = self.board.get_pin('d:9:p')  # d for digital, 9 for pin, p for PWM

        # Create a Scale widget for adjusting the duty cycle
        self.duty_cycle_scale = tk.Scale(master, from_=0, to=100, orient=tk.HORIZONTAL, label="Duty Cycle (%)", command=self.update_brightness)
        self.duty_cycle_scale.set(0)  # Set initial duty cycle to 0%
        self.duty_cycle_scale.pack()

    def update_brightness(self, duty_cycle):
        # Convert duty cycle from 0-100 to 0-1
        duty_cycle = float(duty_cycle) / 100.0
        # Write the duty cycle to the LED pin
        self.led_pin.write(duty_cycle)

    def close(self):
        # Clean up and exit
        self.board.exit()
        self.master.destroy()

# Create the GUI window
root = tk.Tk()
app = ArduinoGUI(root)

# Ensure proper cleanup upon closing the window
root.protocol("WM_DELETE_WINDOW", app.close)

# Run the application
root.mainloop()
